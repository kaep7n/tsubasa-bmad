# Story 4.2: Game List View

## Status
Ready

## Assigned To
James (Dev Agent)

## Story
**As a** coach,
**I want** to see a list of all games,
**so that** I can review past results and see upcoming matches

## Acceptance Criteria
1. ✅ `GameListComponent` with chronological list (upcoming first, then past)
2. ✅ List items display: opponent, date/time, location, home/away, result, status
3. ✅ Data fetched from Supabase, cached to IndexedDB
4. ✅ Filter options: All, Upcoming, Past, Cancelled
5. ✅ Search bar: Filter by opponent name (case-insensitive)
6. ✅ FAB: "Create Game" with sub-menu (Manual Entry, Import Calendar)
7. ✅ Empty state message
8. ✅ Tap item: Navigate to game detail screen
9. ✅ Swipe left: Show edit/delete actions (delete only if not protected)
10. ✅ Offline mode: Works from IndexedDB cache
11. ✅ Pull-to-refresh: Re-fetch from Supabase
12. ✅ Unit test: Verify filtering and sorting
13. ✅ E2E test: Navigate to list, verify games displayed

## Tasks / Subtasks

- [ ] **Task 1: Generate GameListComponent** (AC: 1)
  - [ ] Run: `ng generate component features/games/pages/game-list`
  - [ ] Add route: `/games`
  - [ ] Add to main navigation

- [ ] **Task 2: Build List Template** (AC: 2)
  - [ ] Display opponent name (bold)
  - [ ] Display date/time: "Sat, Oct 28, 2025 - 10:00 AM"
  - [ ] Display location (if provided)
  - [ ] Display Home/Away badge (mat-chip)
  - [ ] Display result badge: W (green), D (yellow), L (red)
  - [ ] Display final score: "3-1"
  - [ ] Display status badge: Scheduled, In Progress, Completed, Cancelled

- [ ] **Task 3: Implement Data Fetching** (AC: 3, 10)
  - [ ] Query: SELECT * FROM games WHERE team_id = {id} AND deleted_at IS NULL ORDER BY date ASC
  - [ ] Save to IndexedDB after fetch
  - [ ] Load from IndexedDB on init (offline-first)
  - [ ] Use signal for reactive state

- [ ] **Task 4: Add Filter Dropdown** (AC: 4)
  - [ ] Options: All Games, Upcoming, Past, Cancelled
  - [ ] Upcoming: date >= today AND status != 'completed'
  - [ ] Past: status = 'completed'
  - [ ] Cancelled: status = 'cancelled'

- [ ] **Task 5: Add Search Bar** (AC: 5)
  - [ ] Text input with mat-icon
  - [ ] Filter by opponent name (case-insensitive)
  - [ ] Real-time filtering

- [ ] **Task 6: Add FAB with Sub-menu** (AC: 6)
  - [ ] Primary FAB: "Create Game" icon
  - [ ] Sub-menu: Manual Entry (navigate to /games/new)
  - [ ] Sub-menu: Import Calendar (open import modal)

- [ ] **Task 7: Add Empty State** (AC: 7)
  - [ ] Show when no games exist
  - [ ] Message: "No games yet - tap + to schedule your first game"

- [ ] **Task 8: Implement Navigation** (AC: 8)
  - [ ] Tap item: Navigate to /games/:id

- [ ] **Task 9: Add Swipe Actions** (AC: 9)
  - [ ] Swipe left: Show Edit and Delete buttons
  - [ ] Delete: Only enabled if is_protected = false
  - [ ] Delete: Show confirmation dialog

- [ ] **Task 10: Add Pull-to-Refresh** (AC: 11)
  - [ ] Implement refresh gesture
  - [ ] Re-fetch from Supabase
  - [ ] Update IndexedDB cache

- [ ] **Task 11: Write Tests** (AC: 12, 13)
  - [ ] Unit test filter logic
  - [ ] Unit test sorting logic
  - [ ] E2E test navigation

## Dev Notes

Component location: `/src/app/features/games/pages/game-list/`

Query optimization: Use compound index on (team_id, date) for efficient chronological sorting.

Offline-first pattern: Always load from IndexedDB first, then sync from Supabase in background.

Protected games cannot be deleted via swipe action to prevent accidental data loss.

[Source: PRD Epic 4 Story 4.2, Architecture Section 12 Lazy-Loaded Features]

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-10-24 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
_To be populated by Dev Agent_

### Debug Log References
_To be populated by Dev Agent_

### Completion Notes List
_To be populated by Dev Agent_

### File List
_To be populated by Dev Agent_

## QA Results
_To be populated by QA Agent_
