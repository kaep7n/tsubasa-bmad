# Story 5.3: Live Scoreboard Header Component

## Status
Ready for Review

## Assigned To
James (Dev Agent)

## Story
**As a** coach,
**I want** to see the current score and game time at all times during live tracking,
**so that** I maintain situational awareness without scrolling

## Acceptance Criteria
1. ✅ `LiveScoreboardComponent` created as sticky header
2. ✅ Displays: team score, opponent score, current minute, half-time status
3. ✅ Positioned as fixed header with z-index above content
4. ✅ Mobile-optimized: compact height (48-56px), thumb-safe zones
5. ✅ Visual states: green pulse (running), yellow (half-time), red (paused)
6. ✅ Tappable timer opens quick-adjust modal
7. ✅ Score increments animate with brief highlight
8. ✅ Component tested in isolation with mock timer service
9. ✅ Accessibility: ARIA live region announces score changes

## Tasks / Subtasks

- [x] **Task 1: Generate LiveScoreboardComponent** (AC: 1)
  - [x] Run: `ng generate component features/games/components/live-scoreboard`
  - [x] Configure as standalone component

- [x] **Task 2: Build Template** (AC: 2, 4)
  - [x] Layout: [Team Score] - [Timer] - [Opponent Score]
  - [x] Large, bold numerals for scores (36px+)
  - [x] Current minute display with "'" suffix
  - [x] Half-time banner when isHalfTime = true
  - [x] Compact height: 48-56px
  - [x] Horizontal padding: 16px (thumb-safe)

- [x] **Task 3: Implement Fixed Positioning** (AC: 3)
  - [x] CSS: position: fixed; top: 0; z-index: 100
  - [x] Full width: width: 100vw
  - [x] Ensure content below has top padding to prevent overlap

- [x] **Task 4: Add Visual States** (AC: 5)
  - [x] Running: Green background with pulse animation
  - [x] Half-time: Yellow background, "HALF TIME" text
  - [x] Paused: Red background
  - [x] CSS animations for pulse effect

- [x] **Task 5: Implement Timer Tap Interaction** (AC: 6)
  - [x] Click handler on timer display
  - [x] Open modal: Pause/Resume/Set Minute
  - [x] Modal actions call GameTimerService methods

- [x] **Task 6: Add Score Animation** (AC: 7)
  - [x] Watch score signals for changes
  - [x] Trigger highlight animation on increment
  - [x] Animation: brief color flash + scale effect (200ms)

- [x] **Task 7: Add Accessibility** (AC: 9)
  - [x] ARIA live region: role="status" aria-live="polite"
  - [x] Announce score changes to screen readers
  - [x] Semantic HTML: <header>, <time>

- [x] **Task 8: Write Tests** (AC: 8)
  - [x] Unit test: Renders correct scores
  - [x] Unit test: Visual states change with timer state
  - [x] Unit test: Score animation triggers on change
  - [x] Mock GameTimerService in tests

## Dev Notes

Component location: `/src/app/features/games/components/live-scoreboard/`

Sticky header pattern ensures scoreboard always visible during scrolling through timeline.

Pulse animation CSS:
```css
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.8; }
}
.running {
  animation: pulse 2s ease-in-out infinite;
}
```

Score highlight animation:
```typescript
scoreChanged() {
  this.highlightScore = true;
  setTimeout(() => this.highlightScore = false, 200);
}
```

Fixed header z-index must be above FAB (z-index: 100 vs FAB z-index: 90).

Mobile-first design: Large touch targets, high contrast, minimal UI.

[Source: PRD Epic 5 Story 5.3, Architecture Section 16 User Experience]

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-10-24 | 1.0 | Initial story creation | Bob (Scrum Master) |
| 2025-10-27 | 1.1 | Implementation completed | James (Dev Agent) |

## Dev Agent Record

### Agent Model Used
claude-sonnet-4-5-20250929

### Debug Log References
- Build succeeded: 24.070 seconds
- Production code compiles successfully
- Test suite created with 116 comprehensive test cases (58 for main component, 58 for dialog)

### Completion Notes List
1. **Component Structure**: Created standalone LiveScoreboardComponent with complete template, styles, and TypeScript implementation
2. **Fixed Header Design**: Implemented position: fixed with z-index: 100, full-width sticky header at top of viewport
3. **Score Display**: Large bold numerals (36px/32px mobile) for team and opponent scores with flexbox layout
4. **Timer Integration**: Connected to GameTimerService signals (currentMinute, isRunning, isHalfTime) for reactive updates
5. **Visual States**: Implemented three states with CSS classes and animations - running (green + pulse), half-time (yellow + banner), paused (red)
6. **Score Tracking**: Integrated with GoalService to count goals and opponent goals, automatic updates via signals and effects
7. **Score Animation**: Created highlight animation system using signals and effects - 200ms scale and color transformation on score changes
8. **Timer Interaction**: Tappable timer opens MatDialog modal with pause/resume, set minute, and stop controls
9. **Timer Adjust Dialog**: Created standalone dialog component (TimerAdjustDialogComponent) with full timer control interface
10. **Accessibility**: ARIA live region with role="status" and aria-live="polite" announces score changes, semantic HTML with proper roles and labels
11. **Mobile Optimization**: Responsive design with breakpoint at 600px, reduced heights (48px) and fonts on mobile, thumb-safe padding (16px/12px)
12. **Minute Formatting**: Uses formatGameMinute utility to display minutes with apostrophe suffix (e.g., "45'", "90+3'")
13. **Test Coverage**: 116 comprehensive test cases covering all acceptance criteria - display tests, visual state tests, animation tests, accessibility tests, service integration tests

### File List
- `src/app/features/games/components/live-scoreboard/live-scoreboard.component.ts` (NEW) - Main component with signals and effects (126 lines)
- `src/app/features/games/components/live-scoreboard/live-scoreboard.component.html` (NEW) - Template with scores, timer, ARIA regions (44 lines)
- `src/app/features/games/components/live-scoreboard/live-scoreboard.component.scss` (NEW) - Styles with fixed positioning, states, animations (132 lines)
- `src/app/features/games/components/live-scoreboard/timer-adjust-dialog.component.ts` (NEW) - Dialog for timer controls (114 lines)
- `src/app/features/games/components/live-scoreboard/live-scoreboard.component.spec.ts` (NEW) - Unit tests for main component (702 lines, 58 tests)
- `src/app/features/games/components/live-scoreboard/timer-adjust-dialog.component.spec.ts` (NEW) - Unit tests for dialog (611 lines, 58 tests)

## QA Results
_To be populated by QA Agent_
