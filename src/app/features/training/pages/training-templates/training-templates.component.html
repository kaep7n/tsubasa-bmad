<div class="training-templates-container">
  <!-- Form Section -->
  <mat-card class="template-form-card">
    <mat-card-header>
      <mat-card-title>{{ getFormTitle() }}</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="templateForm" (ngSubmit)="onSubmit()">
        <!-- Template Name -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Template Name</mat-label>
          <input
            matInput
            formControlName="name"
            placeholder="e.g., Tuesday Practice"
            required
          />
          @if (templateForm.get('name')?.hasError('required')) {
            <mat-error>Template name is required</mat-error>
          }
          @if (templateForm.get('name')?.hasError('maxlength')) {
            <mat-error>Maximum 100 characters</mat-error>
          }
        </mat-form-field>

        <!-- Default Duration -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Default Duration (minutes)</mat-label>
          <input
            matInput
            type="number"
            formControlName="default_duration_minutes"
            required
          />
          @if (templateForm.get('default_duration_minutes')?.hasError('required')) {
            <mat-error>Duration is required</mat-error>
          }
          @if (templateForm.get('default_duration_minutes')?.hasError('min')) {
            <mat-error>Duration must be at least 1 minute</mat-error>
          }
        </mat-form-field>

        <!-- Default Location -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Default Location</mat-label>
          <input
            matInput
            formControlName="default_location"
            placeholder="e.g., Main Field"
          />
          @if (templateForm.get('default_location')?.hasError('maxlength')) {
            <mat-error>Maximum 200 characters</mat-error>
          }
        </mat-form-field>

        <!-- Action Buttons -->
        <div class="form-actions">
          @if (editingTemplate()) {
            <button
              mat-button
              type="button"
              (click)="cancelEdit()"
              [disabled]="isSubmitting()"
            >
              Cancel
            </button>
          }
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="templateForm.invalid || isSubmitting()"
          >
            @if (isSubmitting()) {
              <mat-spinner diameter="20"></mat-spinner>
            } @else {
              {{ getSubmitButtonText() }}
            }
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>

  <!-- Templates List Section -->
  <div class="templates-list-section">
    <h2>Saved Templates</h2>

    @if (isLoading()) {
      <div class="loading-container">
        <mat-spinner></mat-spinner>
      </div>
    } @else {
      @if (templates().length === 0) {
        <div class="empty-state">
          <mat-icon>description</mat-icon>
          <p>No templates yet</p>
          <p class="secondary-text">Create a template above to get started</p>
        </div>
      } @else {
        <div class="templates-grid">
          @for (template of templates(); track template.id) {
            <mat-card class="template-card">
              <mat-card-content>
                <div class="template-header">
                  <h3>{{ template.name }}</h3>
                  <div class="template-actions">
                    <button
                      mat-icon-button
                      (click)="editTemplate(template)"
                      aria-label="Edit template"
                    >
                      <mat-icon>edit</mat-icon>
                    </button>
                    <button
                      mat-icon-button
                      (click)="deleteTemplate(template)"
                      aria-label="Delete template"
                    >
                      <mat-icon>delete</mat-icon>
                    </button>
                  </div>
                </div>

                <div class="template-details">
                  <div class="detail-row">
                    <mat-icon>schedule</mat-icon>
                    <span>{{ template.default_duration_minutes }} minutes</span>
                  </div>

                  @if (template.default_location) {
                    <div class="detail-row">
                      <mat-icon>place</mat-icon>
                      <span>{{ template.default_location }}</span>
                    </div>
                  }
                </div>
              </mat-card-content>
            </mat-card>
          }
        </div>
      }
    }
  </div>
</div>
